<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<!-- Mirrored from dox.sfr-fresh.com/fltk-1.3.0rc3-source/png_8c_source.html by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 16 Feb 2011 23:40:03 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SfR Fresh Dox - fltk: fltk-1.3.0rc3/png/png.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">fltk&#160;<span id="projectnumber">1.3.0rc3</span></div>
   <div id="projectbrief">About: <A HREF= http://www.fltk.org/>FLTK</A> (Fast Light Tool Kit) is a cross-platform C++ GUI toolkit for UNIX/Linux (X11), Microsoft Windows, and MacOS X. Release candidate.<BR><IMG SRC="../warix/forest1.gif" ALT="">&nbsp;&nbsp;<A HREF="http://www.sfr-fresh.com/" TITLE="SfR Fresh Home">SfR Fresh</A> <A HREF="http://www.sfr-fresh.com/warix/features.html#doxygen" TITLE="SfR Fresh Doxygen Support Info">Dox</A>: <A HREF="../fresh/unix/misc/fltk-1.3.0rc3-source.tar.gz/index.html" TITLE="SfR Fresh: fltk-1.3.0rc3-source.tar.gz Contents &amp; Download Page">fltk-1.3.0rc3-source.tar.gz</A> ("inofficial" and yet experimental doxygen-generated source code documentation)&nbsp;&nbsp;<IMG SRC="../warix/forest2.gif" ALT=""><P></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index-2.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('png_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<h1>png.c</h1>  </div>
</div>
<div class="contents">
<a href="png_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="comment">/* png.c - location for general purpose libpng functions</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Last changed in libpng 1.2.39 [August 13, 2009]</span>
<a name="l00005"></a>00005 <span class="comment"> * Copyright (c) 1998-2009 Glenn Randers-Pehrson</span>
<a name="l00006"></a>00006 <span class="comment"> * (Version 0.96 Copyright (c) 1996, 1997 Andreas Dilger)</span>
<a name="l00007"></a>00007 <span class="comment"> * (Version 0.88 Copyright (c) 1995, 1996 Guy Eric Schalnat, Group 42, Inc.)</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> * This code is released under the libpng license.</span>
<a name="l00010"></a>00010 <span class="comment"> * For conditions of distribution and use, see the disclaimer</span>
<a name="l00011"></a>00011 <span class="comment"> * and license in png.h</span>
<a name="l00012"></a>00012 <span class="comment"> */</span>
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="png_8c.html#a9bcff9deb4fb18451aa71db87611f653">00014</a> <span class="preprocessor">#define PNG_INTERNAL</span>
<a name="l00015"></a><a class="code" href="png_8c.html#ac8bafaafd26f8f6cc09261c50c4569ab">00015</a> <span class="preprocessor"></span><span class="preprocessor">#define PNG_NO_EXTERN</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="png_8h.html">png.h</a>&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">/* Generate a compiler error if there is an old png.h in the search path. */</span>
<a name="l00019"></a><a class="code" href="png_8c.html#ae5c43a8c730c67c9774379dc8cfca231">00019</a> <span class="keyword">typedef</span> <a class="code" href="png_8h.html#a473661549d9246051be5d8e6f28d6a89">version_1_2_40</a> <a class="code" href="png_8c.html#ae5c43a8c730c67c9774379dc8cfca231">Your_png_h_is_not_version_1_2_40</a>;
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="comment">/* Version information for C files.  This had better match the version</span>
<a name="l00022"></a>00022 <span class="comment"> * string defined in png.h.  */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#ifdef PNG_USE_GLOBAL_ARRAYS</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="comment">/* png_libpng_ver was changed to a function in version 1.0.5c */</span>
<a name="l00026"></a><a class="code" href="png_8c.html#ae7768b767c5462a6cbf1246a6a863b2b">00026</a> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">char</span> <a class="code" href="png_8c.html#ae7768b767c5462a6cbf1246a6a863b2b">png_libpng_ver</a>[18] = <a class="code" href="png_8h.html#add626ac7b0df735bc999399dbd70c301">PNG_LIBPNG_VER_STRING</a>;
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#ifdef PNG_READ_SUPPORTED</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="comment">/* png_sig was changed to a function in version 1.0.5c */</span>
<a name="l00031"></a>00031 <span class="comment">/* Place to hold the signature string for a PNG file. */</span>
<a name="l00032"></a><a class="code" href="png_8c.html#a029bbcdb22c15dabbd1ddfbf8fd8f4c5">00032</a> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <a class="code" href="pngconf_8h.html#a464361022b28ac2f3ea319b80642e9c3">png_byte</a> <a class="code" href="pngconf_8h.html#a57646c75e8fe12dc591e663390d0730d">FARDATA</a> <a class="code" href="png_8c.html#a029bbcdb22c15dabbd1ddfbf8fd8f4c5">png_sig</a>[8] = {137, 80, 78, 71, 13, 10, 26, 10};
<a name="l00033"></a>00033 <span class="preprocessor">#endif </span><span class="comment">/* PNG_READ_SUPPORTED */</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">/* Invoke global declarations for constant strings for known chunk types */</span>
<a name="l00036"></a><a class="code" href="png_8c.html#a62c03a0e370ae04ec508151b0ef1c7e9">00036</a> <a class="code" href="png_8c.html#a62c03a0e370ae04ec508151b0ef1c7e9">PNG_IHDR</a>;
<a name="l00037"></a><a class="code" href="png_8c.html#a5be5297beca0872ddca5584f31588283">00037</a> <a class="code" href="png_8c.html#a5be5297beca0872ddca5584f31588283">PNG_IDAT</a>;
<a name="l00038"></a><a class="code" href="png_8c.html#a8aff7cc6378eb30512961c5a57b622ac">00038</a> <a class="code" href="png_8c.html#a8aff7cc6378eb30512961c5a57b622ac">PNG_IEND</a>;
<a name="l00039"></a><a class="code" href="png_8c.html#a130bba35ce9ba12cce6fb52725ca637b">00039</a> <a class="code" href="png_8c.html#a130bba35ce9ba12cce6fb52725ca637b">PNG_PLTE</a>;
<a name="l00040"></a><a class="code" href="png_8c.html#a5c12b42ac60e309a2423357eec5842de">00040</a> <a class="code" href="png_8c.html#a5c12b42ac60e309a2423357eec5842de">PNG_bKGD</a>;
<a name="l00041"></a><a class="code" href="png_8c.html#aaef70d975ab98ab0929d8a83bec2afaa">00041</a> <a class="code" href="png_8c.html#aaef70d975ab98ab0929d8a83bec2afaa">PNG_cHRM</a>;
<a name="l00042"></a><a class="code" href="png_8c.html#a5d86fc8d7ef134313b8038d825f1f740">00042</a> <a class="code" href="png_8c.html#a5d86fc8d7ef134313b8038d825f1f740">PNG_gAMA</a>;
<a name="l00043"></a><a class="code" href="png_8c.html#a6d30a78b73b53ac29ad624783212d7de">00043</a> <a class="code" href="png_8c.html#a6d30a78b73b53ac29ad624783212d7de">PNG_hIST</a>;
<a name="l00044"></a><a class="code" href="png_8c.html#a57914d3b056190b10e5c1b8e2c97b99b">00044</a> <a class="code" href="png_8c.html#a57914d3b056190b10e5c1b8e2c97b99b">PNG_iCCP</a>;
<a name="l00045"></a><a class="code" href="png_8c.html#abec37fe6cb998631c47e892d50a4a600">00045</a> <a class="code" href="png_8c.html#abec37fe6cb998631c47e892d50a4a600">PNG_iTXt</a>;
<a name="l00046"></a><a class="code" href="png_8c.html#acea7449c3bd43c3da75e27f29e9a727c">00046</a> <a class="code" href="png_8c.html#acea7449c3bd43c3da75e27f29e9a727c">PNG_oFFs</a>;
<a name="l00047"></a><a class="code" href="png_8c.html#a21132db53209cea1feae8dce2c6e59a5">00047</a> <a class="code" href="png_8c.html#a21132db53209cea1feae8dce2c6e59a5">PNG_pCAL</a>;
<a name="l00048"></a><a class="code" href="png_8c.html#aafc869be316bb054a8ffbad8a1fbc3b5">00048</a> <a class="code" href="png_8c.html#aafc869be316bb054a8ffbad8a1fbc3b5">PNG_sCAL</a>;
<a name="l00049"></a><a class="code" href="png_8c.html#a4cb5664eb3a79ec24409632399443cc7">00049</a> <a class="code" href="png_8c.html#a4cb5664eb3a79ec24409632399443cc7">PNG_pHYs</a>;
<a name="l00050"></a><a class="code" href="png_8c.html#a259ba574d4d13438b4ab04cc71c0874d">00050</a> <a class="code" href="png_8c.html#a259ba574d4d13438b4ab04cc71c0874d">PNG_sBIT</a>;
<a name="l00051"></a><a class="code" href="png_8c.html#a3f1d463e453a6f1429eadee7008bf923">00051</a> <a class="code" href="png_8c.html#a3f1d463e453a6f1429eadee7008bf923">PNG_sPLT</a>;
<a name="l00052"></a><a class="code" href="png_8c.html#a0148c481ebf4e0ae0470784bd34c7e60">00052</a> <a class="code" href="png_8c.html#a0148c481ebf4e0ae0470784bd34c7e60">PNG_sRGB</a>;
<a name="l00053"></a><a class="code" href="png_8c.html#ac91eb20de7e75ac84a93ee7061c1fbe1">00053</a> <a class="code" href="png_8c.html#ac91eb20de7e75ac84a93ee7061c1fbe1">PNG_tEXt</a>;
<a name="l00054"></a><a class="code" href="png_8c.html#a4d702a29d8772addcfc8795e39ebcff0">00054</a> <a class="code" href="png_8c.html#a4d702a29d8772addcfc8795e39ebcff0">PNG_tIME</a>;
<a name="l00055"></a><a class="code" href="png_8c.html#ae8931bf7737e9566ed1fd65447cc0b35">00055</a> <a class="code" href="png_8c.html#ae8931bf7737e9566ed1fd65447cc0b35">PNG_tRNS</a>;
<a name="l00056"></a><a class="code" href="png_8c.html#a7348b14c3b7f14103635ef16bcea4651">00056</a> <a class="code" href="png_8c.html#a7348b14c3b7f14103635ef16bcea4651">PNG_zTXt</a>;
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="preprocessor">#ifdef PNG_READ_SUPPORTED</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="comment">/* Arrays to facilitate easy interlacing - use pass (0 - 6) as index */</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">/* Start of interlace block */</span>
<a name="l00062"></a><a class="code" href="png_8c.html#a6640403408b2dc7ccee5959663f41b0d">00062</a> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a57646c75e8fe12dc591e663390d0730d">FARDATA</a> <a class="code" href="png_8c.html#a6640403408b2dc7ccee5959663f41b0d">png_pass_start</a>[] = {0, 4, 0, 2, 0, 1, 0};
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="comment">/* Offset to next interlace block */</span>
<a name="l00065"></a><a class="code" href="png_8c.html#a22e81c7b74c7d839f99e4bf281fab0ea">00065</a> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a57646c75e8fe12dc591e663390d0730d">FARDATA</a> <a class="code" href="png_8c.html#a22e81c7b74c7d839f99e4bf281fab0ea">png_pass_inc</a>[] = {8, 8, 4, 4, 2, 2, 1};
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/* Start of interlace block in the y direction */</span>
<a name="l00068"></a><a class="code" href="png_8c.html#aa5c2ea1ccb299666657c3623c376c362">00068</a> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a57646c75e8fe12dc591e663390d0730d">FARDATA</a> <a class="code" href="png_8c.html#aa5c2ea1ccb299666657c3623c376c362">png_pass_ystart</a>[] = {0, 0, 4, 0, 2, 0, 1};
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">/* Offset to next interlace block in the y direction */</span>
<a name="l00071"></a><a class="code" href="png_8c.html#a39c9d00cc28d633ef1759a020fa2ea18">00071</a> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a57646c75e8fe12dc591e663390d0730d">FARDATA</a> <a class="code" href="png_8c.html#a39c9d00cc28d633ef1759a020fa2ea18">png_pass_yinc</a>[] = {8, 8, 8, 4, 4, 2, 2};
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">/* Height of interlace block.  This is not currently used - if you need</span>
<a name="l00074"></a>00074 <span class="comment"> * it, uncomment it here and in png.h</span>
<a name="l00075"></a>00075 <span class="comment">PNG_CONST int FARDATA png_pass_height[] = {8, 8, 4, 4, 2, 2, 1};</span>
<a name="l00076"></a>00076 <span class="comment">*/</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">/* Mask to determine which pixels are valid in a pass */</span>
<a name="l00079"></a><a class="code" href="png_8c.html#af33771ff12be957327144940cf352781">00079</a> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a57646c75e8fe12dc591e663390d0730d">FARDATA</a> <a class="code" href="png_8c.html#af33771ff12be957327144940cf352781">png_pass_mask</a>[] = {0x80, 0x08, 0x88, 0x22, 0xaa, 0x55, 0xff};
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/* Mask to determine which pixels to overwrite while displaying */</span>
<a name="l00082"></a>00082 <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a57646c75e8fe12dc591e663390d0730d">FARDATA</a> <a class="code" href="png_8c.html#af5bee83100d64860d540a5ccad773ba3">png_pass_dsp_mask</a>[]
<a name="l00083"></a><a class="code" href="png_8c.html#af5bee83100d64860d540a5ccad773ba3">00083</a>    = {0xff, 0x0f, 0xff, 0x33, 0xff, 0x55, 0xff};
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="preprocessor">#endif </span><span class="comment">/* PNG_READ_SUPPORTED */</span>
<a name="l00086"></a>00086 <span class="preprocessor">#endif </span><span class="comment">/* PNG_USE_GLOBAL_ARRAYS */</span>
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="comment">/* Tells libpng that we have already handled the first &quot;num_bytes&quot; bytes</span>
<a name="l00089"></a>00089 <span class="comment"> * of the PNG file signature.  If the PNG data is embedded into another</span>
<a name="l00090"></a>00090 <span class="comment"> * stream we can set num_bytes = 8 so that libpng will not attempt to read</span>
<a name="l00091"></a>00091 <span class="comment"> * or write any of the magic bytes before it starts on the IHDR.</span>
<a name="l00092"></a>00092 <span class="comment"> */</span>
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="preprocessor">#ifdef PNG_READ_SUPPORTED</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00096"></a><a class="code" href="png_8c.html#a232b842dadb64d22327e8c2a54c87f96">00096</a> <a class="code" href="png_8c.html#a232b842dadb64d22327e8c2a54c87f96">png_set_sig_bytes</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <span class="keywordtype">int</span> <a class="code" href="png_8h.html#af3bf0c8d86afd228847f62c0033cf65d">num_bytes</a>)
<a name="l00097"></a>00097 {
<a name="l00098"></a>00098    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00099"></a>00099       <span class="keywordflow">return</span>;
<a name="l00100"></a>00100    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_set_sig_bytes&quot;</span>);
<a name="l00101"></a>00101    <span class="keywordflow">if</span> (num_bytes &gt; 8)
<a name="l00102"></a>00102       <a class="code" href="pngerror_8c.html#af1f0f467c4308e8fec63fe5627208fea">png_error</a>(png_ptr, <span class="stringliteral">&quot;Too many bytes for PNG signature.&quot;</span>);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104    png_ptr-&gt;sig_bytes = (<a class="code" href="pngconf_8h.html#a464361022b28ac2f3ea319b80642e9c3">png_byte</a>)(num_bytes &lt; 0 ? 0 : num_bytes);
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">/* Checks whether the supplied bytes match the PNG signature.  We allow</span>
<a name="l00108"></a>00108 <span class="comment"> * checking less than the full 8-byte signature so that those apps that</span>
<a name="l00109"></a>00109 <span class="comment"> * already read the first few bytes of a file to determine the file type</span>
<a name="l00110"></a>00110 <span class="comment"> * can simply check the remaining bytes for extra assurance.  Returns</span>
<a name="l00111"></a>00111 <span class="comment"> * an integer less than, equal to, or greater than zero if sig is found,</span>
<a name="l00112"></a>00112 <span class="comment"> * respectively, to be less than, to match, or be greater than the correct</span>
<a name="l00113"></a>00113 <span class="comment"> * PNG signature (this is the same behaviour as strcmp, memcmp, etc).</span>
<a name="l00114"></a>00114 <span class="comment"> */</span>
<a name="l00115"></a>00115 <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00116"></a><a class="code" href="png_8c.html#aad4ef597d2d0c9b85a9bc75652556721">00116</a> <a class="code" href="png_8c.html#aad4ef597d2d0c9b85a9bc75652556721">png_sig_cmp</a>(<a class="code" href="pngconf_8h.html#ad9305b4048360cace50425303f51ab34">png_bytep</a> sig, <a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a> <a class="code" href="png_8h.html#a96c2a358dab02570791a4c9072aecf60">start</a>, <a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a> <a class="code" href="png_8h.html#a065bc3cce1c226d32ea99cca883264f8">num_to_check</a>)
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118    <a class="code" href="pngconf_8h.html#a464361022b28ac2f3ea319b80642e9c3">png_byte</a> png_signature[8] = {137, 80, 78, 71, 13, 10, 26, 10};
<a name="l00119"></a>00119    <span class="keywordflow">if</span> (num_to_check &gt; 8)
<a name="l00120"></a>00120       num_to_check = 8;
<a name="l00121"></a>00121    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_to_check &lt; 1)
<a name="l00122"></a>00122       <span class="keywordflow">return</span> (-1);
<a name="l00123"></a>00123 
<a name="l00124"></a>00124    <span class="keywordflow">if</span> (start &gt; 7)
<a name="l00125"></a>00125       <span class="keywordflow">return</span> (-1);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127    <span class="keywordflow">if</span> (start + num_to_check &gt; 8)
<a name="l00128"></a>00128       num_to_check = 8 - <a class="code" href="png_8h.html#a96c2a358dab02570791a4c9072aecf60">start</a>;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130    <span class="keywordflow">return</span> ((<span class="keywordtype">int</span>)(<a class="code" href="pngconf_8h.html#aa1ba805606e60146793548d2877fca98">png_memcmp</a>(&amp;sig[start], &amp;png_signature[start], num_to_check)));
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="preprocessor">#if defined(PNG_1_0_X) || defined(PNG_1_2_X)</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span><span class="comment">/* (Obsolete) function to check signature bytes.  It does not allow one</span>
<a name="l00135"></a>00135 <span class="comment"> * to check a partial signature.  This function might be removed in the</span>
<a name="l00136"></a>00136 <span class="comment"> * future - use png_sig_cmp().  Returns true (nonzero) if the file is PNG.</span>
<a name="l00137"></a>00137 <span class="comment"> */</span>
<a name="l00138"></a>00138 <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00139"></a><a class="code" href="png_8c.html#aaf4c78927bb310f6ce14a643e8fd8ebc">00139</a> <a class="code" href="png_8c.html#aaf4c78927bb310f6ce14a643e8fd8ebc">png_check_sig</a>(<a class="code" href="pngconf_8h.html#ad9305b4048360cace50425303f51ab34">png_bytep</a> sig, <span class="keywordtype">int</span> <a class="code" href="png_8h.html#ac2d0018d5ab0817c8a1c83c69746a799">num</a>)
<a name="l00140"></a>00140 {
<a name="l00141"></a>00141   <span class="keywordflow">return</span> ((<span class="keywordtype">int</span>)!<a class="code" href="png_8c.html#aad4ef597d2d0c9b85a9bc75652556721">png_sig_cmp</a>(sig, (<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)0, (<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)num));
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 <span class="preprocessor">#endif</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* PNG_READ_SUPPORTED */</span>
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="preprocessor">#if defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED)</span>
<a name="l00147"></a>00147 <span class="preprocessor"></span><span class="comment">/* Function to allocate memory for zlib and clear it to 0. */</span>
<a name="l00148"></a>00148 <span class="preprocessor">#ifdef PNG_1_0_X</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span><a class="code" href="zconf_8h.html#a04c731495379021454c8e61439dc88ec">voidpf</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00150"></a>00150 <span class="preprocessor">#else</span>
<a name="l00151"></a>00151 <span class="preprocessor"></span><a class="code" href="zconf_8h.html#a04c731495379021454c8e61439dc88ec">voidpf</a> <span class="comment">/* PRIVATE */</span>
<a name="l00152"></a>00152 <span class="preprocessor">#endif</span>
<a name="l00153"></a><a class="code" href="png_8c.html#a8bd1d33f6ce2df46efbd6c2d91222d21">00153</a> <span class="preprocessor"></span><a class="code" href="png_8c.html#a8bd1d33f6ce2df46efbd6c2d91222d21">png_zalloc</a>(<a class="code" href="zconf_8h.html#a04c731495379021454c8e61439dc88ec">voidpf</a> png_ptr, <a class="code" href="zconf_8h.html#a87d141052bcd5ec8a80812a565c70369">uInt</a> items, <a class="code" href="zconf_8h.html#a87d141052bcd5ec8a80812a565c70369">uInt</a> <a class="code" href="png_8h.html#a43291b8493b637821dec145c4bb1503d">size</a>)
<a name="l00154"></a>00154 {
<a name="l00155"></a>00155    <a class="code" href="pngconf_8h.html#a0d4487cb739519f7edd1dbaa0916d28d">png_voidp</a> <a class="code" href="png_8h.html#a95138b534309370df8c31b354dfcbe45">ptr</a>;
<a name="l00156"></a>00156    <a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> p=(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a>)png_ptr;
<a name="l00157"></a>00157    <a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a> save_flags=p-&gt;flags;
<a name="l00158"></a>00158    <a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a> <a class="code" href="png_8h.html#af3bf0c8d86afd228847f62c0033cf65d">num_bytes</a>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00161"></a>00161       <span class="keywordflow">return</span> (<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00162"></a>00162    <span class="keywordflow">if</span> (items &gt; <a class="code" href="png_8h.html#a8219b12566428b809e81fb97ccbec7ce">PNG_UINT_32_MAX</a>/size)
<a name="l00163"></a>00163    {
<a name="l00164"></a>00164      <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a> (p, <span class="stringliteral">&quot;Potential overflow in png_zalloc()&quot;</span>);
<a name="l00165"></a>00165      <span class="keywordflow">return</span> (<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00166"></a>00166    }
<a name="l00167"></a>00167    num_bytes = (<a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a>)items * size;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169    p-&gt;flags|=PNG_FLAG_MALLOC_NULL_MEM_OK;
<a name="l00170"></a>00170    ptr = (<a class="code" href="pngconf_8h.html#a0d4487cb739519f7edd1dbaa0916d28d">png_voidp</a>)<a class="code" href="pngmem_8c.html#ab63bb53a5581c3df790ac6f78d760b3e">png_malloc</a>((<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a>)png_ptr, <a class="code" href="png_8h.html#af3bf0c8d86afd228847f62c0033cf65d">num_bytes</a>);
<a name="l00171"></a>00171    p-&gt;flags=save_flags;
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 <span class="preprocessor">#if defined(PNG_1_0_X) &amp;&amp; !defined(PNG_NO_ZALLOC_ZERO)</span>
<a name="l00174"></a>00174 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00175"></a>00175        <span class="keywordflow">return</span> ((<a class="code" href="zconf_8h.html#a04c731495379021454c8e61439dc88ec">voidpf</a>)<a class="code" href="png_8h.html#a95138b534309370df8c31b354dfcbe45">ptr</a>);
<a name="l00176"></a>00176 
<a name="l00177"></a>00177    <span class="keywordflow">if</span> (num_bytes &gt; (<a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a>)0x8000L)
<a name="l00178"></a>00178    {
<a name="l00179"></a>00179       <a class="code" href="pngconf_8h.html#a13978b57d9482facf252d67cfd1b76b9">png_memset</a>(ptr, 0, (<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)0x8000L);
<a name="l00180"></a>00180       <a class="code" href="pngconf_8h.html#a13978b57d9482facf252d67cfd1b76b9">png_memset</a>((<a class="code" href="pngconf_8h.html#ad9305b4048360cace50425303f51ab34">png_bytep</a>)ptr + (<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)0x8000L, 0,
<a name="l00181"></a>00181          (<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)(num_bytes - (<a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a>)0x8000L));
<a name="l00182"></a>00182    }
<a name="l00183"></a>00183    <span class="keywordflow">else</span>
<a name="l00184"></a>00184    {
<a name="l00185"></a>00185       <a class="code" href="pngconf_8h.html#a13978b57d9482facf252d67cfd1b76b9">png_memset</a>(ptr, 0, (<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)num_bytes);
<a name="l00186"></a>00186    }
<a name="l00187"></a>00187 <span class="preprocessor">#endif</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span>   <span class="keywordflow">return</span> ((<a class="code" href="zconf_8h.html#a04c731495379021454c8e61439dc88ec">voidpf</a>)ptr);
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">/* Function to free memory for zlib */</span>
<a name="l00192"></a>00192 <span class="preprocessor">#ifdef PNG_1_0_X</span>
<a name="l00193"></a>00193 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00194"></a>00194 <span class="preprocessor">#else</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span><span class="keywordtype">void</span> <span class="comment">/* PRIVATE */</span>
<a name="l00196"></a>00196 <span class="preprocessor">#endif</span>
<a name="l00197"></a><a class="code" href="png_8c.html#a6b973046dc43f07f5bfd4e0e898b8a85">00197</a> <span class="preprocessor"></span><a class="code" href="png_8c.html#a6b973046dc43f07f5bfd4e0e898b8a85">png_zfree</a>(<a class="code" href="zconf_8h.html#a04c731495379021454c8e61439dc88ec">voidpf</a> png_ptr, <a class="code" href="zconf_8h.html#a04c731495379021454c8e61439dc88ec">voidpf</a> <a class="code" href="png_8h.html#a95138b534309370df8c31b354dfcbe45">ptr</a>)
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199    <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>((<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a>)png_ptr, (<a class="code" href="pngconf_8h.html#a0d4487cb739519f7edd1dbaa0916d28d">png_voidp</a>)ptr);
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 <span class="comment">/* Reset the CRC variable to 32 bits of 1&#39;s.  Care must be taken</span>
<a name="l00203"></a>00203 <span class="comment"> * in case CRC is &gt; 32 bits to leave the top bits 0.</span>
<a name="l00204"></a>00204 <span class="comment"> */</span>
<a name="l00205"></a>00205 <span class="keywordtype">void</span> <span class="comment">/* PRIVATE */</span>
<a name="l00206"></a><a class="code" href="png_8c.html#a6fec62edbd808e156c5d83ea0787f350">00206</a> <a class="code" href="png_8c.html#a6fec62edbd808e156c5d83ea0787f350">png_reset_crc</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208    png_ptr-&gt;crc = <a class="code" href="crc32_8c.html#a5d6fb454f076e5762905a247702c9be3">crc32</a>(0, <a class="code" href="zlib_8h.html#ad15afa2776b41b2f4d8582dd152bd736">Z_NULL</a>, 0);
<a name="l00209"></a>00209 }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="comment">/* Calculate the CRC over a section of data.  We can only pass as</span>
<a name="l00212"></a>00212 <span class="comment"> * much data to this routine as the largest single buffer size.  We</span>
<a name="l00213"></a>00213 <span class="comment"> * also check that this data will actually be used before going to the</span>
<a name="l00214"></a>00214 <span class="comment"> * trouble of calculating it.</span>
<a name="l00215"></a>00215 <span class="comment"> */</span>
<a name="l00216"></a>00216 <span class="keywordtype">void</span> <span class="comment">/* PRIVATE */</span>
<a name="l00217"></a><a class="code" href="png_8c.html#ae98129fab75e65498c340113eaa599fd">00217</a> <a class="code" href="png_8c.html#ae98129fab75e65498c340113eaa599fd">png_calculate_crc</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="pngconf_8h.html#ad9305b4048360cace50425303f51ab34">png_bytep</a> <a class="code" href="png_8h.html#a95138b534309370df8c31b354dfcbe45">ptr</a>, <a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a> <a class="code" href="png_8h.html#ae403475fe6a2c471cf8dd689e3049953">length</a>)
<a name="l00218"></a>00218 {
<a name="l00219"></a>00219    <span class="keywordtype">int</span> need_crc = 1;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221    <span class="keywordflow">if</span> (png_ptr-&gt;chunk_name[0] &amp; 0x20)                     <span class="comment">/* ancillary */</span>
<a name="l00222"></a>00222    {
<a name="l00223"></a>00223       <span class="keywordflow">if</span> ((png_ptr-&gt;flags &amp; PNG_FLAG_CRC_ANCILLARY_MASK) ==
<a name="l00224"></a>00224           (PNG_FLAG_CRC_ANCILLARY_USE | PNG_FLAG_CRC_ANCILLARY_NOWARN))
<a name="l00225"></a>00225          need_crc = 0;
<a name="l00226"></a>00226    }
<a name="l00227"></a>00227    <span class="keywordflow">else</span>                                                    <span class="comment">/* critical */</span>
<a name="l00228"></a>00228    {
<a name="l00229"></a>00229       <span class="keywordflow">if</span> (png_ptr-&gt;flags &amp; PNG_FLAG_CRC_CRITICAL_IGNORE)
<a name="l00230"></a>00230          need_crc = 0;
<a name="l00231"></a>00231    }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233    <span class="keywordflow">if</span> (need_crc)
<a name="l00234"></a>00234       png_ptr-&gt;crc = <a class="code" href="crc32_8c.html#a5d6fb454f076e5762905a247702c9be3">crc32</a>(png_ptr-&gt;crc, ptr, (<a class="code" href="zconf_8h.html#a87d141052bcd5ec8a80812a565c70369">uInt</a>)length);
<a name="l00235"></a>00235 }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 <span class="comment">/* Allocate the memory for an info_struct for the application.  We don&#39;t</span>
<a name="l00238"></a>00238 <span class="comment"> * really need the png_ptr, but it could potentially be useful in the</span>
<a name="l00239"></a>00239 <span class="comment"> * future.  This should be used in favour of malloc(png_sizeof(png_info))</span>
<a name="l00240"></a>00240 <span class="comment"> * and png_info_init() so that applications that want to use a shared</span>
<a name="l00241"></a>00241 <span class="comment"> * libpng don&#39;t have to be recompiled if png_info changes size.</span>
<a name="l00242"></a>00242 <span class="comment"> */</span>
<a name="l00243"></a>00243 <a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00244"></a><a class="code" href="png_8c.html#afaf600dde6e51b9d9ae09dfed09111a7">00244</a> <a class="code" href="png_8c.html#afaf600dde6e51b9d9ae09dfed09111a7">png_create_info_struct</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00245"></a>00245 {
<a name="l00246"></a>00246    <a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a>;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_create_info_struct&quot;</span>);
<a name="l00249"></a>00249    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00250"></a>00250       <span class="keywordflow">return</span> (<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00251"></a>00251 <span class="preprocessor">#ifdef PNG_USER_MEM_SUPPORTED</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span>   info_ptr = (<a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a>)<a class="code" href="pngmem_8c.html#a2f8ec4433de67c89a2718d5dc3d7d126">png_create_struct_2</a>(PNG_STRUCT_INFO,
<a name="l00253"></a>00253       png_ptr-&gt;malloc_fn, png_ptr-&gt;mem_ptr);
<a name="l00254"></a>00254 <span class="preprocessor">#else</span>
<a name="l00255"></a>00255 <span class="preprocessor"></span>   info_ptr = (<a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a>)<a class="code" href="pngmem_8c.html#a796ae85a99b9f7106f704786205b251b">png_create_struct</a>(PNG_STRUCT_INFO);
<a name="l00256"></a>00256 <span class="preprocessor">#endif</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (info_ptr != <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00258"></a>00258       <a class="code" href="png_8c.html#a8485c747cd8080ab06c8e365aab0ae35">png_info_init_3</a>(&amp;info_ptr, <a class="code" href="pngconf_8h.html#a18c80f490efdb3ecfc2bb6aa840a94c0">png_sizeof</a>(<a class="code" href="structpng__info__struct.html">png_info</a>));
<a name="l00259"></a>00259 
<a name="l00260"></a>00260    <span class="keywordflow">return</span> (info_ptr);
<a name="l00261"></a>00261 }
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 <span class="comment">/* This function frees the memory associated with a single info struct.</span>
<a name="l00264"></a>00264 <span class="comment"> * Normally, one would use either png_destroy_read_struct() or</span>
<a name="l00265"></a>00265 <span class="comment"> * png_destroy_write_struct() to free an info struct, but this may be</span>
<a name="l00266"></a>00266 <span class="comment"> * useful for some applications.</span>
<a name="l00267"></a>00267 <span class="comment"> */</span>
<a name="l00268"></a>00268 <span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00269"></a><a class="code" href="png_8c.html#a8f8e4b0e328789b7dd13eb29f7c31d2d">00269</a> <a class="code" href="png_8c.html#a8f8e4b0e328789b7dd13eb29f7c31d2d">png_destroy_info_struct</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="png_8h.html#a7707bf17eea730cc70c032f456823876">png_infopp</a> <a class="code" href="png_8h.html#ab0b97c0754596fd3a36e7a2a2cbf96ba">info_ptr_ptr</a>)
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271    <a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a> = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00272"></a>00272    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00273"></a>00273       <span class="keywordflow">return</span>;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_destroy_info_struct&quot;</span>);
<a name="l00276"></a>00276    <span class="keywordflow">if</span> (info_ptr_ptr != <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00277"></a>00277       info_ptr = *<a class="code" href="png_8h.html#ab0b97c0754596fd3a36e7a2a2cbf96ba">info_ptr_ptr</a>;
<a name="l00278"></a>00278 
<a name="l00279"></a>00279    <span class="keywordflow">if</span> (info_ptr != <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00280"></a>00280    {
<a name="l00281"></a>00281       <a class="code" href="png_8c.html#a566f0a6dd8bb395c5dd5bbb4e8d70092">png_info_destroy</a>(png_ptr, info_ptr);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="preprocessor">#ifdef PNG_USER_MEM_SUPPORTED</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span>      <a class="code" href="pngmem_8c.html#ab3df81253a8b890d9590a5e9b599f19c">png_destroy_struct_2</a>((<a class="code" href="pngconf_8h.html#a0d4487cb739519f7edd1dbaa0916d28d">png_voidp</a>)info_ptr, png_ptr-&gt;free_fn,
<a name="l00285"></a>00285           png_ptr-&gt;mem_ptr);
<a name="l00286"></a>00286 <span class="preprocessor">#else</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span>      <a class="code" href="pngmem_8c.html#a6c1b97e380665e6ad49e65816e572431">png_destroy_struct</a>((<a class="code" href="pngconf_8h.html#a0d4487cb739519f7edd1dbaa0916d28d">png_voidp</a>)info_ptr);
<a name="l00288"></a>00288 <span class="preprocessor">#endif</span>
<a name="l00289"></a>00289 <span class="preprocessor"></span>      *info_ptr_ptr = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00290"></a>00290    }
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 <span class="comment">/* Initialize the info structure.  This is now an internal function (0.89)</span>
<a name="l00294"></a>00294 <span class="comment"> * and applications using it are urged to use png_create_info_struct()</span>
<a name="l00295"></a>00295 <span class="comment"> * instead.</span>
<a name="l00296"></a>00296 <span class="comment"> */</span>
<a name="l00297"></a>00297 <span class="preprocessor">#if defined(PNG_1_0_X) || defined(PNG_1_2_X)</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span><span class="preprocessor">#undef png_info_init</span>
<a name="l00299"></a>00299 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00300"></a><a class="code" href="png_8c.html#a057ece4c488597b2d378511133b93462">00300</a> <a class="code" href="png_8c.html#a057ece4c488597b2d378511133b93462">png_info_init</a>(<a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a>)
<a name="l00301"></a>00301 {
<a name="l00302"></a>00302    <span class="comment">/* We only come here via pre-1.0.12-compiled applications */</span>
<a name="l00303"></a>00303    <a class="code" href="png_8c.html#a8485c747cd8080ab06c8e365aab0ae35">png_info_init_3</a>(&amp;info_ptr, 0);
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 <span class="preprocessor">#endif</span>
<a name="l00306"></a>00306 <span class="preprocessor"></span>
<a name="l00307"></a>00307 <span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00308"></a><a class="code" href="png_8c.html#a8485c747cd8080ab06c8e365aab0ae35">00308</a> <a class="code" href="png_8c.html#a8485c747cd8080ab06c8e365aab0ae35">png_info_init_3</a>(<a class="code" href="png_8h.html#a7707bf17eea730cc70c032f456823876">png_infopp</a> ptr_ptr, <a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a> <a class="code" href="png_8h.html#ab4a95bf8e09f1435f33a30eebd053edd">png_info_struct_size</a>)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310    <a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a> = *ptr_ptr;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312    <span class="keywordflow">if</span> (info_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00313"></a>00313       <span class="keywordflow">return</span>;
<a name="l00314"></a>00314 
<a name="l00315"></a>00315    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_info_init_3&quot;</span>);
<a name="l00316"></a>00316 
<a name="l00317"></a>00317    <span class="keywordflow">if</span> (<a class="code" href="pngconf_8h.html#a18c80f490efdb3ecfc2bb6aa840a94c0">png_sizeof</a>(<a class="code" href="structpng__info__struct.html">png_info</a>) &gt; png_info_struct_size)
<a name="l00318"></a>00318    {
<a name="l00319"></a>00319       <a class="code" href="pngmem_8c.html#a6c1b97e380665e6ad49e65816e572431">png_destroy_struct</a>(info_ptr);
<a name="l00320"></a>00320       info_ptr = (<a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a>)<a class="code" href="pngmem_8c.html#a796ae85a99b9f7106f704786205b251b">png_create_struct</a>(PNG_STRUCT_INFO);
<a name="l00321"></a>00321       *ptr_ptr = <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a>;
<a name="l00322"></a>00322    }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324    <span class="comment">/* Set everything to 0 */</span>
<a name="l00325"></a>00325    <a class="code" href="pngconf_8h.html#a13978b57d9482facf252d67cfd1b76b9">png_memset</a>(info_ptr, 0, <a class="code" href="pngconf_8h.html#a18c80f490efdb3ecfc2bb6aa840a94c0">png_sizeof</a>(<a class="code" href="structpng__info__struct.html">png_info</a>));
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00329"></a>00329 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00330"></a><a class="code" href="png_8c.html#ae980699cf9a8166de939c4cb2c518abd">00330</a> <a class="code" href="png_8c.html#ae980699cf9a8166de939c4cb2c518abd">png_data_freer</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a>,
<a name="l00331"></a>00331    <span class="keywordtype">int</span> <a class="code" href="png_8h.html#a3e78cec2b2cad2ab180ff9f66661fac2">freer</a>, <a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a> <a class="code" href="png_8h.html#aa61e47f2cb0ad7631948cd857c77164f">mask</a>)
<a name="l00332"></a>00332 {
<a name="l00333"></a>00333    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_data_freer&quot;</span>);
<a name="l00334"></a>00334    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || info_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00335"></a>00335       <span class="keywordflow">return</span>;
<a name="l00336"></a>00336    <span class="keywordflow">if</span> (freer == <a class="code" href="png_8h.html#a97b06ee7046237a6b05c2a64c48b195b">PNG_DESTROY_WILL_FREE_DATA</a>)
<a name="l00337"></a>00337       info_ptr-&gt;free_me |= <a class="code" href="png_8h.html#aa61e47f2cb0ad7631948cd857c77164f">mask</a>;
<a name="l00338"></a>00338    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (freer == <a class="code" href="png_8h.html#ab066ff821bbc3a369cc2d99b0ee63418">PNG_USER_WILL_FREE_DATA</a>)
<a name="l00339"></a>00339       info_ptr-&gt;free_me &amp;= ~mask;
<a name="l00340"></a>00340    <span class="keywordflow">else</span>
<a name="l00341"></a>00341       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr,
<a name="l00342"></a>00342          <span class="stringliteral">&quot;Unknown freer parameter in png_data_freer.&quot;</span>);
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 <span class="preprocessor">#endif</span>
<a name="l00345"></a>00345 <span class="preprocessor"></span>
<a name="l00346"></a>00346 <span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00347"></a><a class="code" href="png_8c.html#a1ae8b6cd0016a7a7f8bbc8987fad16e7">00347</a> <a class="code" href="png_8c.html#a1ae8b6cd0016a7a7f8bbc8987fad16e7">png_free_data</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a>, <a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a> <a class="code" href="png_8h.html#aa61e47f2cb0ad7631948cd857c77164f">mask</a>,
<a name="l00348"></a>00348    <span class="keywordtype">int</span> <a class="code" href="png_8h.html#ac2d0018d5ab0817c8a1c83c69746a799">num</a>)
<a name="l00349"></a>00349 {
<a name="l00350"></a>00350    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_free_data&quot;</span>);
<a name="l00351"></a>00351    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || info_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00352"></a>00352       <span class="keywordflow">return</span>;
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="preprocessor">#if defined(PNG_TEXT_SUPPORTED)</span>
<a name="l00355"></a>00355 <span class="preprocessor"></span>   <span class="comment">/* Free text item num or (if num == -1) all text items */</span>
<a name="l00356"></a>00356 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00357"></a>00357 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#a65434d591944eea79613059532e8d23c">PNG_FREE_TEXT</a>) &amp; info_ptr-&gt;free_me)
<a name="l00358"></a>00358 <span class="preprocessor">#else</span>
<a name="l00359"></a>00359 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mask &amp; PNG_FREE_TEXT)
<a name="l00360"></a>00360 <span class="preprocessor">#endif</span>
<a name="l00361"></a>00361 <span class="preprocessor"></span>   {
<a name="l00362"></a>00362       <span class="keywordflow">if</span> (num != -1)
<a name="l00363"></a>00363       {
<a name="l00364"></a>00364          <span class="keywordflow">if</span> (info_ptr-&gt;text &amp;&amp; info_ptr-&gt;text[num].key)
<a name="l00365"></a>00365          {
<a name="l00366"></a>00366             <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;text[num].key);
<a name="l00367"></a>00367             info_ptr-&gt;text[<a class="code" href="png_8h.html#ac2d0018d5ab0817c8a1c83c69746a799">num</a>].key = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00368"></a>00368          }
<a name="l00369"></a>00369       }
<a name="l00370"></a>00370       <span class="keywordflow">else</span>
<a name="l00371"></a>00371       {
<a name="l00372"></a>00372          <span class="keywordtype">int</span> <a class="code" href="png_8h.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;
<a name="l00373"></a>00373          <span class="keywordflow">for</span> (i = 0; i &lt; info_ptr-&gt;num_text; i++)
<a name="l00374"></a>00374              <a class="code" href="png_8c.html#a1ae8b6cd0016a7a7f8bbc8987fad16e7">png_free_data</a>(png_ptr, info_ptr, PNG_FREE_TEXT, i);
<a name="l00375"></a>00375          <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;text);
<a name="l00376"></a>00376          info_ptr-&gt;text = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00377"></a>00377          info_ptr-&gt;num_text=0;
<a name="l00378"></a>00378       }
<a name="l00379"></a>00379    }
<a name="l00380"></a>00380 <span class="preprocessor">#endif</span>
<a name="l00381"></a>00381 <span class="preprocessor"></span>
<a name="l00382"></a>00382 <span class="preprocessor">#if defined(PNG_tRNS_SUPPORTED)</span>
<a name="l00383"></a>00383 <span class="preprocessor"></span>   <span class="comment">/* Free any tRNS entry */</span>
<a name="l00384"></a>00384 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00385"></a>00385 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#a73c5c677920bed32f88b2d91b5c8ccdd">PNG_FREE_TRNS</a>) &amp; info_ptr-&gt;free_me)
<a name="l00386"></a>00386 <span class="preprocessor">#else</span>
<a name="l00387"></a>00387 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; PNG_FREE_TRNS) &amp;&amp; (png_ptr-&gt;flags &amp; PNG_FLAG_FREE_TRNS))
<a name="l00388"></a>00388 <span class="preprocessor">#endif</span>
<a name="l00389"></a>00389 <span class="preprocessor"></span>   {
<a name="l00390"></a>00390       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;trans);
<a name="l00391"></a>00391       info_ptr-&gt;trans = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00392"></a>00392       info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#ac320d65a35dc24161c7fe1b7cecc984c">PNG_INFO_tRNS</a>;
<a name="l00393"></a>00393 <span class="preprocessor">#ifndef PNG_FREE_ME_SUPPORTED</span>
<a name="l00394"></a>00394 <span class="preprocessor"></span>      png_ptr-&gt;flags &amp;= ~PNG_FLAG_FREE_TRNS;
<a name="l00395"></a>00395 <span class="preprocessor">#endif</span>
<a name="l00396"></a>00396 <span class="preprocessor"></span>   }
<a name="l00397"></a>00397 <span class="preprocessor">#endif</span>
<a name="l00398"></a>00398 <span class="preprocessor"></span>
<a name="l00399"></a>00399 <span class="preprocessor">#if defined(PNG_sCAL_SUPPORTED)</span>
<a name="l00400"></a>00400 <span class="preprocessor"></span>   <span class="comment">/* Free any sCAL entry */</span>
<a name="l00401"></a>00401 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00402"></a>00402 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#acaabc260276941f93f432a1fe7ee24f7">PNG_FREE_SCAL</a>) &amp; info_ptr-&gt;free_me)
<a name="l00403"></a>00403 <span class="preprocessor">#else</span>
<a name="l00404"></a>00404 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mask &amp; PNG_FREE_SCAL)
<a name="l00405"></a>00405 <span class="preprocessor">#endif</span>
<a name="l00406"></a>00406 <span class="preprocessor"></span>   {
<a name="l00407"></a>00407 <span class="preprocessor">#if defined(PNG_FIXED_POINT_SUPPORTED) &amp;&amp; !defined(PNG_FLOATING_POINT_SUPPORTED)</span>
<a name="l00408"></a>00408 <span class="preprocessor"></span>      <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;scal_s_width);
<a name="l00409"></a>00409       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;scal_s_height);
<a name="l00410"></a>00410       info_ptr-&gt;scal_s_width = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00411"></a>00411       info_ptr-&gt;scal_s_height = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00412"></a>00412 <span class="preprocessor">#endif</span>
<a name="l00413"></a>00413 <span class="preprocessor"></span>      info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#ac4a42c2872a9521165c6bf142aec9d58">PNG_INFO_sCAL</a>;
<a name="l00414"></a>00414    }
<a name="l00415"></a>00415 <span class="preprocessor">#endif</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>
<a name="l00417"></a>00417 <span class="preprocessor">#if defined(PNG_pCAL_SUPPORTED)</span>
<a name="l00418"></a>00418 <span class="preprocessor"></span>   <span class="comment">/* Free any pCAL entry */</span>
<a name="l00419"></a>00419 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00420"></a>00420 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#a6a56009bc4333fd834aae11f1f2f38a3">PNG_FREE_PCAL</a>) &amp; info_ptr-&gt;free_me)
<a name="l00421"></a>00421 <span class="preprocessor">#else</span>
<a name="l00422"></a>00422 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mask &amp; PNG_FREE_PCAL)
<a name="l00423"></a>00423 <span class="preprocessor">#endif</span>
<a name="l00424"></a>00424 <span class="preprocessor"></span>   {
<a name="l00425"></a>00425       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;pcal_purpose);
<a name="l00426"></a>00426       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;pcal_units);
<a name="l00427"></a>00427       info_ptr-&gt;pcal_purpose = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00428"></a>00428       info_ptr-&gt;pcal_units = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00429"></a>00429       <span class="keywordflow">if</span> (info_ptr-&gt;pcal_params != <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00430"></a>00430          {
<a name="l00431"></a>00431             <span class="keywordtype">int</span> <a class="code" href="png_8h.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;
<a name="l00432"></a>00432             <span class="keywordflow">for</span> (i = 0; i &lt; (<a class="code" href="png_8h.html#ab832c174e145540d491b0830fc05dbb1">int</a>)info_ptr-&gt;pcal_nparams; i++)
<a name="l00433"></a>00433             {
<a name="l00434"></a>00434                <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;pcal_params[i]);
<a name="l00435"></a>00435                info_ptr-&gt;pcal_params[<a class="code" href="png_8h.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>]=<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00436"></a>00436             }
<a name="l00437"></a>00437             <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;pcal_params);
<a name="l00438"></a>00438             info_ptr-&gt;pcal_params = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00439"></a>00439          }
<a name="l00440"></a>00440       info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#a66eb2c5114cabc1c7fe7a20c78a11599">PNG_INFO_pCAL</a>;
<a name="l00441"></a>00441    }
<a name="l00442"></a>00442 <span class="preprocessor">#endif</span>
<a name="l00443"></a>00443 <span class="preprocessor"></span>
<a name="l00444"></a>00444 <span class="preprocessor">#if defined(PNG_iCCP_SUPPORTED)</span>
<a name="l00445"></a>00445 <span class="preprocessor"></span>   <span class="comment">/* Free any iCCP entry */</span>
<a name="l00446"></a>00446 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#a1bfd1e30ba17945811053774ca4a6d7a">PNG_FREE_ICCP</a>) &amp; info_ptr-&gt;free_me)
<a name="l00448"></a>00448 <span class="preprocessor">#else</span>
<a name="l00449"></a>00449 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mask &amp; PNG_FREE_ICCP)
<a name="l00450"></a>00450 <span class="preprocessor">#endif</span>
<a name="l00451"></a>00451 <span class="preprocessor"></span>   {
<a name="l00452"></a>00452       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;iccp_name);
<a name="l00453"></a>00453       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;iccp_profile);
<a name="l00454"></a>00454       info_ptr-&gt;iccp_name = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00455"></a>00455       info_ptr-&gt;iccp_profile = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00456"></a>00456       info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#ad78688298bf51b245e36ddf6efc6ead3">PNG_INFO_iCCP</a>;
<a name="l00457"></a>00457    }
<a name="l00458"></a>00458 <span class="preprocessor">#endif</span>
<a name="l00459"></a>00459 <span class="preprocessor"></span>
<a name="l00460"></a>00460 <span class="preprocessor">#if defined(PNG_sPLT_SUPPORTED)</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span>   <span class="comment">/* Free a given sPLT entry, or (if num == -1) all sPLT entries */</span>
<a name="l00462"></a>00462 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00463"></a>00463 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#adc87df8d0f2d84580c49a284fd66292a">PNG_FREE_SPLT</a>) &amp; info_ptr-&gt;free_me)
<a name="l00464"></a>00464 <span class="preprocessor">#else</span>
<a name="l00465"></a>00465 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mask &amp; PNG_FREE_SPLT)
<a name="l00466"></a>00466 <span class="preprocessor">#endif</span>
<a name="l00467"></a>00467 <span class="preprocessor"></span>   {
<a name="l00468"></a>00468       <span class="keywordflow">if</span> (num != -1)
<a name="l00469"></a>00469       {
<a name="l00470"></a>00470          <span class="keywordflow">if</span> (info_ptr-&gt;splt_palettes)
<a name="l00471"></a>00471          {
<a name="l00472"></a>00472             <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;splt_palettes[num].name);
<a name="l00473"></a>00473             <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;splt_palettes[num].entries);
<a name="l00474"></a>00474             info_ptr-&gt;splt_palettes[<a class="code" href="png_8h.html#ac2d0018d5ab0817c8a1c83c69746a799">num</a>].name = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00475"></a>00475             info_ptr-&gt;splt_palettes[<a class="code" href="png_8h.html#ac2d0018d5ab0817c8a1c83c69746a799">num</a>].entries = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00476"></a>00476          }
<a name="l00477"></a>00477       }
<a name="l00478"></a>00478       <span class="keywordflow">else</span>
<a name="l00479"></a>00479       {
<a name="l00480"></a>00480          <span class="keywordflow">if</span> (info_ptr-&gt;splt_palettes_num)
<a name="l00481"></a>00481          {
<a name="l00482"></a>00482             <span class="keywordtype">int</span> <a class="code" href="png_8h.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;
<a name="l00483"></a>00483             <span class="keywordflow">for</span> (i = 0; i &lt; (<a class="code" href="png_8h.html#ab832c174e145540d491b0830fc05dbb1">int</a>)info_ptr-&gt;splt_palettes_num; i++)
<a name="l00484"></a>00484                <a class="code" href="png_8c.html#a1ae8b6cd0016a7a7f8bbc8987fad16e7">png_free_data</a>(png_ptr, info_ptr, PNG_FREE_SPLT, i);
<a name="l00485"></a>00485 
<a name="l00486"></a>00486             <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;splt_palettes);
<a name="l00487"></a>00487             info_ptr-&gt;splt_palettes = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00488"></a>00488             info_ptr-&gt;splt_palettes_num = 0;
<a name="l00489"></a>00489          }
<a name="l00490"></a>00490          info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#a4bd1fee7a4ca11429bbad68afbba807c">PNG_INFO_sPLT</a>;
<a name="l00491"></a>00491       }
<a name="l00492"></a>00492    }
<a name="l00493"></a>00493 <span class="preprocessor">#endif</span>
<a name="l00494"></a>00494 <span class="preprocessor"></span>
<a name="l00495"></a>00495 <span class="preprocessor">#if defined(PNG_UNKNOWN_CHUNKS_SUPPORTED)</span>
<a name="l00496"></a>00496 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (png_ptr-&gt;unknown_chunk.data)
<a name="l00497"></a>00497    {
<a name="l00498"></a>00498       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, png_ptr-&gt;unknown_chunk.data);
<a name="l00499"></a>00499       png_ptr-&gt;unknown_chunk.data = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00500"></a>00500    }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#a2af8bb17e254d6095e4bf22af2e68126">PNG_FREE_UNKN</a>) &amp; info_ptr-&gt;free_me)
<a name="l00504"></a>00504 <span class="preprocessor">#else</span>
<a name="l00505"></a>00505 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mask &amp; PNG_FREE_UNKN)
<a name="l00506"></a>00506 <span class="preprocessor">#endif</span>
<a name="l00507"></a>00507 <span class="preprocessor"></span>   {
<a name="l00508"></a>00508       <span class="keywordflow">if</span> (num != -1)
<a name="l00509"></a>00509       {
<a name="l00510"></a>00510           <span class="keywordflow">if</span> (info_ptr-&gt;unknown_chunks)
<a name="l00511"></a>00511           {
<a name="l00512"></a>00512              <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;unknown_chunks[num].data);
<a name="l00513"></a>00513              info_ptr-&gt;unknown_chunks[<a class="code" href="png_8h.html#ac2d0018d5ab0817c8a1c83c69746a799">num</a>].data = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00514"></a>00514           }
<a name="l00515"></a>00515       }
<a name="l00516"></a>00516       <span class="keywordflow">else</span>
<a name="l00517"></a>00517       {
<a name="l00518"></a>00518          <span class="keywordtype">int</span> <a class="code" href="png_8h.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520          <span class="keywordflow">if</span> (info_ptr-&gt;unknown_chunks_num)
<a name="l00521"></a>00521          {
<a name="l00522"></a>00522             <span class="keywordflow">for</span> (i = 0; i &lt; (<a class="code" href="png_8h.html#ab832c174e145540d491b0830fc05dbb1">int</a>)info_ptr-&gt;unknown_chunks_num; i++)
<a name="l00523"></a>00523                <a class="code" href="png_8c.html#a1ae8b6cd0016a7a7f8bbc8987fad16e7">png_free_data</a>(png_ptr, info_ptr, PNG_FREE_UNKN, i);
<a name="l00524"></a>00524 
<a name="l00525"></a>00525             <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;unknown_chunks);
<a name="l00526"></a>00526             info_ptr-&gt;unknown_chunks = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00527"></a>00527             info_ptr-&gt;unknown_chunks_num = 0;
<a name="l00528"></a>00528          }
<a name="l00529"></a>00529       }
<a name="l00530"></a>00530    }
<a name="l00531"></a>00531 <span class="preprocessor">#endif</span>
<a name="l00532"></a>00532 <span class="preprocessor"></span>
<a name="l00533"></a>00533 <span class="preprocessor">#if defined(PNG_hIST_SUPPORTED)</span>
<a name="l00534"></a>00534 <span class="preprocessor"></span>   <span class="comment">/* Free any hIST entry */</span>
<a name="l00535"></a>00535 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00536"></a>00536 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#ab649f0387d94dde319157574d270d1d1">PNG_FREE_HIST</a>)  &amp; info_ptr-&gt;free_me)
<a name="l00537"></a>00537 <span class="preprocessor">#else</span>
<a name="l00538"></a>00538 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; PNG_FREE_HIST) &amp;&amp; (png_ptr-&gt;flags &amp; PNG_FLAG_FREE_HIST))
<a name="l00539"></a>00539 <span class="preprocessor">#endif</span>
<a name="l00540"></a>00540 <span class="preprocessor"></span>   {
<a name="l00541"></a>00541       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;hist);
<a name="l00542"></a>00542       info_ptr-&gt;hist = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00543"></a>00543       info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#acf0773d96150d423a7d081b927db636b">PNG_INFO_hIST</a>;
<a name="l00544"></a>00544 <span class="preprocessor">#ifndef PNG_FREE_ME_SUPPORTED</span>
<a name="l00545"></a>00545 <span class="preprocessor"></span>      png_ptr-&gt;flags &amp;= ~PNG_FLAG_FREE_HIST;
<a name="l00546"></a>00546 <span class="preprocessor">#endif</span>
<a name="l00547"></a>00547 <span class="preprocessor"></span>   }
<a name="l00548"></a>00548 <span class="preprocessor">#endif</span>
<a name="l00549"></a>00549 <span class="preprocessor"></span>
<a name="l00550"></a>00550    <span class="comment">/* Free any PLTE entry that was internally allocated */</span>
<a name="l00551"></a>00551 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00552"></a>00552 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#a0320996ea88274c8ec9d018e575f4366">PNG_FREE_PLTE</a>) &amp; info_ptr-&gt;free_me)
<a name="l00553"></a>00553 <span class="preprocessor">#else</span>
<a name="l00554"></a>00554 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; PNG_FREE_PLTE) &amp;&amp; (png_ptr-&gt;flags &amp; PNG_FLAG_FREE_PLTE))
<a name="l00555"></a>00555 <span class="preprocessor">#endif</span>
<a name="l00556"></a>00556 <span class="preprocessor"></span>   {
<a name="l00557"></a>00557       <a class="code" href="png_8c.html#a6b973046dc43f07f5bfd4e0e898b8a85">png_zfree</a>(png_ptr, info_ptr-&gt;palette);
<a name="l00558"></a>00558       info_ptr-&gt;palette = <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00559"></a>00559       info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#ad9379d42a627b95cbbb2082b642079e7">PNG_INFO_PLTE</a>;
<a name="l00560"></a>00560 <span class="preprocessor">#ifndef PNG_FREE_ME_SUPPORTED</span>
<a name="l00561"></a>00561 <span class="preprocessor"></span>      png_ptr-&gt;flags &amp;= ~PNG_FLAG_FREE_PLTE;
<a name="l00562"></a>00562 <span class="preprocessor">#endif</span>
<a name="l00563"></a>00563 <span class="preprocessor"></span>      info_ptr-&gt;num_palette = 0;
<a name="l00564"></a>00564    }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 <span class="preprocessor">#if defined(PNG_INFO_IMAGE_SUPPORTED)</span>
<a name="l00567"></a>00567 <span class="preprocessor"></span>   <span class="comment">/* Free any image bits attached to the info structure */</span>
<a name="l00568"></a>00568 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00569"></a>00569 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ((mask &amp; <a class="code" href="png_8h.html#acd8c14ad4810657cb313ec9af60782ee">PNG_FREE_ROWS</a>) &amp; info_ptr-&gt;free_me)
<a name="l00570"></a>00570 <span class="preprocessor">#else</span>
<a name="l00571"></a>00571 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mask &amp; PNG_FREE_ROWS)
<a name="l00572"></a>00572 <span class="preprocessor">#endif</span>
<a name="l00573"></a>00573 <span class="preprocessor"></span>   {
<a name="l00574"></a>00574       <span class="keywordflow">if</span> (info_ptr-&gt;row_pointers)
<a name="l00575"></a>00575       {
<a name="l00576"></a>00576          <span class="keywordtype">int</span> <a class="code" href="png_8h.html#a73cf8a72b60ad0318e2eb4f8076dcb40">row</a>;
<a name="l00577"></a>00577          <span class="keywordflow">for</span> (row = 0; row &lt; (<a class="code" href="png_8h.html#ab832c174e145540d491b0830fc05dbb1">int</a>)info_ptr-&gt;height; row++)
<a name="l00578"></a>00578          {
<a name="l00579"></a>00579             <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;row_pointers[row]);
<a name="l00580"></a>00580             info_ptr-&gt;row_pointers[<a class="code" href="png_8h.html#a73cf8a72b60ad0318e2eb4f8076dcb40">row</a>]=<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00581"></a>00581          }
<a name="l00582"></a>00582          <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, info_ptr-&gt;row_pointers);
<a name="l00583"></a>00583          info_ptr-&gt;row_pointers=<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00584"></a>00584       }
<a name="l00585"></a>00585       info_ptr-&gt;valid &amp;= ~<a class="code" href="png_8h.html#a7eb9626ed53101c39d26823b1cb63515">PNG_INFO_IDAT</a>;
<a name="l00586"></a>00586    }
<a name="l00587"></a>00587 <span class="preprocessor">#endif</span>
<a name="l00588"></a>00588 <span class="preprocessor"></span>
<a name="l00589"></a>00589 <span class="preprocessor">#ifdef PNG_FREE_ME_SUPPORTED</span>
<a name="l00590"></a>00590 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (num == -1)
<a name="l00591"></a>00591       info_ptr-&gt;free_me &amp;= ~mask;
<a name="l00592"></a>00592    <span class="keywordflow">else</span>
<a name="l00593"></a>00593       info_ptr-&gt;free_me &amp;= ~(mask &amp; ~<a class="code" href="png_8h.html#abb1c2725da27f4dfd63a81aebcbd62b3">PNG_FREE_MUL</a>);
<a name="l00594"></a>00594 <span class="preprocessor">#endif</span>
<a name="l00595"></a>00595 <span class="preprocessor"></span>}
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 <span class="comment">/* This is an internal routine to free any memory that the info struct is</span>
<a name="l00598"></a>00598 <span class="comment"> * pointing to before re-using it or freeing the struct itself.  Recall</span>
<a name="l00599"></a>00599 <span class="comment"> * that png_free() checks for NULL pointers for us.</span>
<a name="l00600"></a>00600 <span class="comment"> */</span>
<a name="l00601"></a>00601 <span class="keywordtype">void</span> <span class="comment">/* PRIVATE */</span>
<a name="l00602"></a><a class="code" href="png_8c.html#a566f0a6dd8bb395c5dd5bbb4e8d70092">00602</a> <a class="code" href="png_8c.html#a566f0a6dd8bb395c5dd5bbb4e8d70092">png_info_destroy</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="png_8h.html#ab1f46fcc45e053a9fcb32c8b2ccc0866">png_infop</a> <a class="code" href="png_8h.html#acff20584e44b8e5b6ebd0ef649fd89f9">info_ptr</a>)
<a name="l00603"></a>00603 {
<a name="l00604"></a>00604    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_info_destroy&quot;</span>);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606    <a class="code" href="png_8c.html#a1ae8b6cd0016a7a7f8bbc8987fad16e7">png_free_data</a>(png_ptr, info_ptr, <a class="code" href="png_8h.html#a6ef8f780a7a6b2c6c3776c9188f86731">PNG_FREE_ALL</a>, -1);
<a name="l00607"></a>00607 
<a name="l00608"></a>00608 <span class="preprocessor">#if defined(PNG_HANDLE_AS_UNKNOWN_SUPPORTED)</span>
<a name="l00609"></a>00609 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (png_ptr-&gt;num_chunk_list)
<a name="l00610"></a>00610    {
<a name="l00611"></a>00611       <a class="code" href="pngmem_8c.html#a6b14e847afcaed26a92542cfa0b3326a">png_free</a>(png_ptr, png_ptr-&gt;chunk_list);
<a name="l00612"></a>00612       png_ptr-&gt;chunk_list=<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00613"></a>00613       png_ptr-&gt;num_chunk_list = 0;
<a name="l00614"></a>00614    }
<a name="l00615"></a>00615 <span class="preprocessor">#endif</span>
<a name="l00616"></a>00616 <span class="preprocessor"></span>
<a name="l00617"></a>00617    <a class="code" href="png_8c.html#a8485c747cd8080ab06c8e365aab0ae35">png_info_init_3</a>(&amp;info_ptr, <a class="code" href="pngconf_8h.html#a18c80f490efdb3ecfc2bb6aa840a94c0">png_sizeof</a>(<a class="code" href="structpng__info__struct.html">png_info</a>));
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 <span class="preprocessor">#endif </span><span class="comment">/* defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED) */</span>
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 <span class="comment">/* This function returns a pointer to the io_ptr associated with the user</span>
<a name="l00622"></a>00622 <span class="comment"> * functions.  The application should free any memory associated with this</span>
<a name="l00623"></a>00623 <span class="comment"> * pointer before png_write_destroy() or png_read_destroy() are called.</span>
<a name="l00624"></a>00624 <span class="comment"> */</span>
<a name="l00625"></a>00625 <a class="code" href="pngconf_8h.html#a0d4487cb739519f7edd1dbaa0916d28d">png_voidp</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00626"></a><a class="code" href="png_8c.html#a4881b01a7071348fb8bad211ea4ccf2c">00626</a> <a class="code" href="png_8c.html#a4881b01a7071348fb8bad211ea4ccf2c">png_get_io_ptr</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00627"></a>00627 {
<a name="l00628"></a>00628    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00629"></a>00629       <span class="keywordflow">return</span> (<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00630"></a>00630    <span class="keywordflow">return</span> (png_ptr-&gt;io_ptr);
<a name="l00631"></a>00631 }
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 <span class="preprocessor">#if defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED)</span>
<a name="l00634"></a>00634 <span class="preprocessor"></span><span class="preprocessor">#if !defined(PNG_NO_STDIO)</span>
<a name="l00635"></a>00635 <span class="preprocessor"></span><span class="comment">/* Initialize the default input/output functions for the PNG file.  If you</span>
<a name="l00636"></a>00636 <span class="comment"> * use your own read or write routines, you can call either png_set_read_fn()</span>
<a name="l00637"></a>00637 <span class="comment"> * or png_set_write_fn() instead of png_init_io().  If you have defined</span>
<a name="l00638"></a>00638 <span class="comment"> * PNG_NO_STDIO, you must use a function of your own because &quot;FILE *&quot; isn&#39;t</span>
<a name="l00639"></a>00639 <span class="comment"> * necessarily available.</span>
<a name="l00640"></a>00640 <span class="comment"> */</span>
<a name="l00641"></a>00641 <span class="keywordtype">void</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00642"></a><a class="code" href="png_8c.html#ada81de71a2560c00f8db93eb4727f450">00642</a> <a class="code" href="png_8c.html#ada81de71a2560c00f8db93eb4727f450">png_init_io</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="pngconf_8h.html#a4040bc99a3ff92ba82fcd4e645e35bed">png_FILE_p</a> <a class="code" href="png_8h.html#a2fc770f3075676bb456388a905f1cc99">fp</a>)
<a name="l00643"></a>00643 {
<a name="l00644"></a>00644    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in png_init_io&quot;</span>);
<a name="l00645"></a>00645    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00646"></a>00646       <span class="keywordflow">return</span>;
<a name="l00647"></a>00647    png_ptr-&gt;io_ptr = (<a class="code" href="pngconf_8h.html#a0d4487cb739519f7edd1dbaa0916d28d">png_voidp</a>)fp;
<a name="l00648"></a>00648 }
<a name="l00649"></a>00649 <span class="preprocessor">#endif</span>
<a name="l00650"></a>00650 <span class="preprocessor"></span>
<a name="l00651"></a>00651 <span class="preprocessor">#if defined(PNG_TIME_RFC1123_SUPPORTED)</span>
<a name="l00652"></a>00652 <span class="preprocessor"></span><span class="comment">/* Convert the supplied time into an RFC 1123 string suitable for use in</span>
<a name="l00653"></a>00653 <span class="comment"> * a &quot;Creation Time&quot; or other text-based time string.</span>
<a name="l00654"></a>00654 <span class="comment"> */</span>
<a name="l00655"></a>00655 <a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00656"></a><a class="code" href="png_8c.html#afaab83a390cc021c6cbfd182687928c6">00656</a> <a class="code" href="png_8c.html#afaab83a390cc021c6cbfd182687928c6">png_convert_to_rfc1123</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="png_8h.html#a4d2b7fb7206a91dd86bd401c04a50fcf">png_timep</a> <a class="code" href="png_8h.html#aece2bf2fecb9ea60f4e6447c1804785a">ptime</a>)
<a name="l00657"></a>00657 {
<a name="l00658"></a>00658    <span class="keyword">static</span> <a class="code" href="pngconf_8h.html#ab86c4fb86cd835c779bdb0aab716e12e">PNG_CONST</a> <span class="keywordtype">char</span> short_months[12][4] =
<a name="l00659"></a>00659         {<span class="stringliteral">&quot;Jan&quot;</span>, <span class="stringliteral">&quot;Feb&quot;</span>, <span class="stringliteral">&quot;Mar&quot;</span>, <span class="stringliteral">&quot;Apr&quot;</span>, <span class="stringliteral">&quot;May&quot;</span>, <span class="stringliteral">&quot;Jun&quot;</span>,
<a name="l00660"></a>00660          <span class="stringliteral">&quot;Jul&quot;</span>, <span class="stringliteral">&quot;Aug&quot;</span>, <span class="stringliteral">&quot;Sep&quot;</span>, <span class="stringliteral">&quot;Oct&quot;</span>, <span class="stringliteral">&quot;Nov&quot;</span>, <span class="stringliteral">&quot;Dec&quot;</span>};
<a name="l00661"></a>00661 
<a name="l00662"></a>00662    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00663"></a>00663       <span class="keywordflow">return</span> (<a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00664"></a>00664    <span class="keywordflow">if</span> (png_ptr-&gt;time_buffer == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00665"></a>00665    {
<a name="l00666"></a>00666       png_ptr-&gt;time_buffer = (<a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a>)<a class="code" href="pngmem_8c.html#ab63bb53a5581c3df790ac6f78d760b3e">png_malloc</a>(png_ptr, (<a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a>)(29*
<a name="l00667"></a>00667          <a class="code" href="pngconf_8h.html#a18c80f490efdb3ecfc2bb6aa840a94c0">png_sizeof</a>(<span class="keywordtype">char</span>)));
<a name="l00668"></a>00668    }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 <span class="preprocessor">#if defined(_WIN32_WCE)</span>
<a name="l00671"></a>00671 <span class="preprocessor"></span>   {
<a name="l00672"></a>00672       <span class="keywordtype">wchar_t</span> time_buf[29];
<a name="l00673"></a>00673       wsprintf(time_buf, TEXT(<span class="stringliteral">&quot;%d %S %d %02d:%02d:%02d +0000&quot;</span>),
<a name="l00674"></a>00674           ptime-&gt;day % 32, short_months[(ptime-&gt;month - 1) % 12],
<a name="l00675"></a>00675         ptime-&gt;year, ptime-&gt;hour % 24, ptime-&gt;minute % 60,
<a name="l00676"></a>00676           ptime-&gt;second % 61);
<a name="l00677"></a>00677       WideCharToMultiByte(CP_ACP, 0, time_buf, -1, png_ptr-&gt;time_buffer, 29,
<a name="l00678"></a>00678           <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00679"></a>00679    }
<a name="l00680"></a>00680 <span class="preprocessor">#else</span>
<a name="l00681"></a>00681 <span class="preprocessor"></span><span class="preprocessor">#ifdef USE_FAR_KEYWORD</span>
<a name="l00682"></a>00682 <span class="preprocessor"></span>   {
<a name="l00683"></a>00683       <span class="keywordtype">char</span> near_time_buf[29];
<a name="l00684"></a>00684       <a class="code" href="pngconf_8h.html#a97613c3e79eedfbfba756d9781b82b43">png_snprintf6</a>(near_time_buf, 29, <span class="stringliteral">&quot;%d %s %d %02d:%02d:%02d +0000&quot;</span>,
<a name="l00685"></a>00685           ptime-&gt;day % 32, short_months[(ptime-&gt;month - 1) % 12],
<a name="l00686"></a>00686           ptime-&gt;year, ptime-&gt;hour % 24, ptime-&gt;minute % 60,
<a name="l00687"></a>00687           ptime-&gt;second % 61);
<a name="l00688"></a>00688       <a class="code" href="pngconf_8h.html#a142df9a55255d0878cc17a10957acbd9">png_memcpy</a>(png_ptr-&gt;time_buffer, near_time_buf,
<a name="l00689"></a>00689           29*<a class="code" href="pngconf_8h.html#a18c80f490efdb3ecfc2bb6aa840a94c0">png_sizeof</a>(<span class="keywordtype">char</span>));
<a name="l00690"></a>00690    }
<a name="l00691"></a>00691 <span class="preprocessor">#else</span>
<a name="l00692"></a>00692 <span class="preprocessor"></span>   <a class="code" href="pngconf_8h.html#a97613c3e79eedfbfba756d9781b82b43">png_snprintf6</a>(png_ptr-&gt;time_buffer, 29, <span class="stringliteral">&quot;%d %s %d %02d:%02d:%02d +0000&quot;</span>,
<a name="l00693"></a>00693        ptime-&gt;day % 32, short_months[(ptime-&gt;month - 1) % 12],
<a name="l00694"></a>00694        ptime-&gt;year, ptime-&gt;hour % 24, ptime-&gt;minute % 60,
<a name="l00695"></a>00695        ptime-&gt;second % 61);
<a name="l00696"></a>00696 <span class="preprocessor">#endif</span>
<a name="l00697"></a>00697 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* _WIN32_WCE */</span>
<a name="l00698"></a>00698    <span class="keywordflow">return</span> ((<a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a>)png_ptr-&gt;time_buffer);
<a name="l00699"></a>00699 }
<a name="l00700"></a>00700 <span class="preprocessor">#endif </span><span class="comment">/* PNG_TIME_RFC1123_SUPPORTED */</span>
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="preprocessor">#endif </span><span class="comment">/* defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED) */</span>
<a name="l00703"></a>00703 
<a name="l00704"></a>00704 <a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00705"></a><a class="code" href="png_8c.html#acef1e2f999bc9ac24b553efff448029e">00705</a> <a class="code" href="png_8c.html#acef1e2f999bc9ac24b553efff448029e">png_get_copyright</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00706"></a>00706 {
<a name="l00707"></a>00707    png_ptr = png_ptr;  <span class="comment">/* Silence compiler warning about unused png_ptr */</span>
<a name="l00708"></a>00708    <span class="keywordflow">return</span> ((<a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a>) <span class="stringliteral">&quot;\n libpng version 1.2.40 - September 10, 2009\n\</span>
<a name="l00709"></a>00709 <span class="stringliteral">   Copyright (c) 1998-2009 Glenn Randers-Pehrson\n\</span>
<a name="l00710"></a>00710 <span class="stringliteral">   Copyright (c) 1996-1997 Andreas Dilger\n\</span>
<a name="l00711"></a>00711 <span class="stringliteral">   Copyright (c) 1995-1996 Guy Eric Schalnat, Group 42, Inc.\n&quot;</span>);
<a name="l00712"></a>00712 }
<a name="l00713"></a>00713 
<a name="l00714"></a>00714 <span class="comment">/* The following return the library version as a short string in the</span>
<a name="l00715"></a>00715 <span class="comment"> * format 1.0.0 through 99.99.99zz.  To get the version of *.h files</span>
<a name="l00716"></a>00716 <span class="comment"> * used with your application, print out PNG_LIBPNG_VER_STRING, which</span>
<a name="l00717"></a>00717 <span class="comment"> * is defined in png.h.</span>
<a name="l00718"></a>00718 <span class="comment"> * Note: now there is no difference between png_get_libpng_ver() and</span>
<a name="l00719"></a>00719 <span class="comment"> * png_get_header_ver().  Due to the version_nn_nn_nn typedef guard,</span>
<a name="l00720"></a>00720 <span class="comment"> * it is guaranteed that png.c uses the correct version of png.h.</span>
<a name="l00721"></a>00721 <span class="comment"> */</span>
<a name="l00722"></a>00722 <a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00723"></a><a class="code" href="png_8c.html#a3b8d8d17282cd61fac141addbaee7687">00723</a> <a class="code" href="png_8c.html#a3b8d8d17282cd61fac141addbaee7687">png_get_libpng_ver</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00724"></a>00724 {
<a name="l00725"></a>00725    <span class="comment">/* Version of *.c files used when building libpng */</span>
<a name="l00726"></a>00726    png_ptr = png_ptr;  <span class="comment">/* Silence compiler warning about unused png_ptr */</span>
<a name="l00727"></a>00727    <span class="keywordflow">return</span> ((<a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a>) <a class="code" href="png_8h.html#add626ac7b0df735bc999399dbd70c301">PNG_LIBPNG_VER_STRING</a>);
<a name="l00728"></a>00728 }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 <a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00731"></a><a class="code" href="png_8c.html#a36cc04871dfd31a3409af8d85a7d9ece">00731</a> <a class="code" href="png_8c.html#a36cc04871dfd31a3409af8d85a7d9ece">png_get_header_ver</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00732"></a>00732 {
<a name="l00733"></a>00733    <span class="comment">/* Version of *.h files used when building libpng */</span>
<a name="l00734"></a>00734    png_ptr = png_ptr;  <span class="comment">/* Silence compiler warning about unused png_ptr */</span>
<a name="l00735"></a>00735    <span class="keywordflow">return</span> ((<a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a>) <a class="code" href="png_8h.html#add626ac7b0df735bc999399dbd70c301">PNG_LIBPNG_VER_STRING</a>);
<a name="l00736"></a>00736 }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00739"></a><a class="code" href="png_8c.html#ac4bd9788df7e81d3299a3a50e28b07c7">00739</a> <a class="code" href="png_8c.html#ac4bd9788df7e81d3299a3a50e28b07c7">png_get_header_version</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00740"></a>00740 {
<a name="l00741"></a>00741    <span class="comment">/* Returns longer string containing both version and date */</span>
<a name="l00742"></a>00742    png_ptr = png_ptr;  <span class="comment">/* Silence compiler warning about unused png_ptr */</span>
<a name="l00743"></a>00743    <span class="keywordflow">return</span> ((<a class="code" href="pngconf_8h.html#aecb1137924b0368861c8f569df2573b2">png_charp</a>) <a class="code" href="png_8h.html#a8f0858dc09dbec509c29970debaf92a3">PNG_HEADER_VERSION_STRING</a>
<a name="l00744"></a>00744 #ifndef <a class="code" href="pngconf_8h.html#a010f432fee916109af9e111224e4a4f7">PNG_READ_SUPPORTED</a>
<a name="l00745"></a>00745    <span class="stringliteral">&quot;     (NO READ SUPPORT)&quot;</span>
<a name="l00746"></a>00746 #endif
<a name="l00747"></a>00747    <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00748"></a>00748 }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 <span class="preprocessor">#if defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED)</span>
<a name="l00751"></a>00751 <span class="preprocessor"></span><span class="preprocessor">#ifdef PNG_HANDLE_AS_UNKNOWN_SUPPORTED</span>
<a name="l00752"></a>00752 <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00753"></a><a class="code" href="png_8c.html#a2ee26f4865d58a73db1bad3a5ca6c06e">00753</a> <a class="code" href="png_8c.html#a2ee26f4865d58a73db1bad3a5ca6c06e">png_handle_as_unknown</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr, <a class="code" href="pngconf_8h.html#ad9305b4048360cace50425303f51ab34">png_bytep</a> <a class="code" href="png_8h.html#a0c909dfdd07f7dbfbdf3717de5c3d210">chunk_name</a>)
<a name="l00754"></a>00754 {
<a name="l00755"></a>00755    <span class="comment">/* Check chunk_name and return &quot;keep&quot; value if it&#39;s on the list, else 0 */</span>
<a name="l00756"></a>00756    <span class="keywordtype">int</span> <a class="code" href="png_8h.html#ac8936188af0c1d2f8b9d0cd25fde43b2">i</a>;
<a name="l00757"></a>00757    <a class="code" href="pngconf_8h.html#ad9305b4048360cace50425303f51ab34">png_bytep</a> p;
<a name="l00758"></a>00758    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || chunk_name == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || png_ptr-&gt;num_chunk_list&lt;=0)
<a name="l00759"></a>00759       <span class="keywordflow">return</span> 0;
<a name="l00760"></a>00760    p = png_ptr-&gt;chunk_list + png_ptr-&gt;num_chunk_list*5 - 5;
<a name="l00761"></a>00761    <span class="keywordflow">for</span> (i = png_ptr-&gt;num_chunk_list; i; i--, p -= 5)
<a name="l00762"></a>00762       <span class="keywordflow">if</span> (!<a class="code" href="pngconf_8h.html#aa1ba805606e60146793548d2877fca98">png_memcmp</a>(chunk_name, p, 4))
<a name="l00763"></a>00763         <span class="keywordflow">return</span> ((<span class="keywordtype">int</span>)*(p + 4));
<a name="l00764"></a>00764    <span class="keywordflow">return</span> 0;
<a name="l00765"></a>00765 }
<a name="l00766"></a>00766 <span class="preprocessor">#endif</span>
<a name="l00767"></a>00767 <span class="preprocessor"></span>
<a name="l00768"></a>00768 <span class="comment">/* This function, added to libpng-1.0.6g, is untested. */</span>
<a name="l00769"></a>00769 <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00770"></a><a class="code" href="png_8c.html#a0859c91d3f451785474833ae30686370">00770</a> <a class="code" href="png_8c.html#a0859c91d3f451785474833ae30686370">png_reset_zstream</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr)
<a name="l00771"></a>00771 {
<a name="l00772"></a>00772    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00773"></a>00773       <span class="keywordflow">return</span> <a class="code" href="zlib_8h.html#aad97cde83a9a4bb77f5c3b03bb68e483">Z_STREAM_ERROR</a>;
<a name="l00774"></a>00774    <span class="keywordflow">return</span> (<a class="code" href="inflate_8c.html#adb02c2100f9179f4075b220395b1553c">inflateReset</a>(&amp;png_ptr-&gt;zstream));
<a name="l00775"></a>00775 }
<a name="l00776"></a>00776 <span class="preprocessor">#endif </span><span class="comment">/* defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED) */</span>
<a name="l00777"></a>00777 
<a name="l00778"></a>00778 <span class="comment">/* This function was added to libpng-1.0.7 */</span>
<a name="l00779"></a>00779 <a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00780"></a><a class="code" href="png_8c.html#adcf74eb8d1c01b3947355671db674353">00780</a> <a class="code" href="png_8c.html#adcf74eb8d1c01b3947355671db674353">png_access_version_number</a>(<span class="keywordtype">void</span>)
<a name="l00781"></a>00781 {
<a name="l00782"></a>00782    <span class="comment">/* Version of *.c files used when building libpng */</span>
<a name="l00783"></a>00783    <span class="keywordflow">return</span>((<a class="code" href="pngconf_8h.html#a2a8d8733e0a9dade8874c24548e6dabd">png_uint_32</a>) <a class="code" href="png_8h.html#a897c0f665a5e289d0a4a51dc580c4de7">PNG_LIBPNG_VER</a>);
<a name="l00784"></a>00784 }
<a name="l00785"></a>00785 
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 <span class="preprocessor">#if defined(PNG_READ_SUPPORTED) &amp;&amp; defined(PNG_ASSEMBLER_CODE_SUPPORTED)</span>
<a name="l00788"></a>00788 <span class="preprocessor"></span><span class="preprocessor">#if !defined(PNG_1_0_X)</span>
<a name="l00789"></a>00789 <span class="preprocessor"></span><span class="comment">/* This function was added to libpng 1.2.0 */</span>
<a name="l00790"></a>00790 <span class="keywordtype">int</span> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00791"></a><a class="code" href="png_8c.html#a4513b50ba34c26921f88cd1db7de5015">00791</a> <a class="code" href="png_8c.html#a4513b50ba34c26921f88cd1db7de5015">png_mmx_support</a>(<span class="keywordtype">void</span>)
<a name="l00792"></a>00792 {
<a name="l00793"></a>00793    <span class="comment">/* Obsolete, to be removed from libpng-1.4.0 */</span>
<a name="l00794"></a>00794     <span class="keywordflow">return</span> -1;
<a name="l00795"></a>00795 }
<a name="l00796"></a>00796 <span class="preprocessor">#endif </span><span class="comment">/* PNG_1_0_X */</span>
<a name="l00797"></a>00797 <span class="preprocessor">#endif </span><span class="comment">/* PNG_READ_SUPPORTED &amp;&amp; PNG_ASSEMBLER_CODE_SUPPORTED */</span>
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 <span class="preprocessor">#if defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED)</span>
<a name="l00800"></a>00800 <span class="preprocessor"></span><span class="preprocessor">#ifdef PNG_SIZE_T</span>
<a name="l00801"></a>00801 <span class="preprocessor"></span><span class="comment">/* Added at libpng version 1.2.6 */</span>
<a name="l00802"></a>00802    PNG_EXTERN <a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a> png_convert_size <a class="code" href="pngconf_8h.html#a7f0a65bb873ad5f2409155335492dacd">PNGARG</a>((<span class="keywordtype">size_t</span> <a class="code" href="png_8h.html#a43291b8493b637821dec145c4bb1503d">size</a>));
<a name="l00803"></a>00803 <a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a> <a class="code" href="pngconf_8h.html#a618eb992ee4d84d25d62175d6cc2c4c2">PNGAPI</a>
<a name="l00804"></a>00804 png_convert_size(<span class="keywordtype">size_t</span> <a class="code" href="png_8h.html#a43291b8493b637821dec145c4bb1503d">size</a>)
<a name="l00805"></a>00805 {
<a name="l00806"></a>00806    <span class="keywordflow">if</span> (size &gt; (<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)-1)
<a name="l00807"></a>00807       <a class="code" href="pngconf_8h.html#ab3e1eac212986f488cd8305860130e94">PNG_ABORT</a>();  <span class="comment">/* We haven&#39;t got access to png_ptr, so no png_error() */</span>
<a name="l00808"></a>00808    <span class="keywordflow">return</span> ((<a class="code" href="pngconf_8h.html#a975e35d0a699ea3b08b8feef90fd29eb">png_size_t</a>)size);
<a name="l00809"></a>00809 }
<a name="l00810"></a>00810 <span class="preprocessor">#endif </span><span class="comment">/* PNG_SIZE_T */</span>
<a name="l00811"></a>00811 
<a name="l00812"></a>00812 <span class="comment">/* Added at libpng version 1.2.34 and 1.4.0 (moved from pngset.c) */</span>
<a name="l00813"></a>00813 <span class="preprocessor">#if defined(PNG_cHRM_SUPPORTED)</span>
<a name="l00814"></a>00814 <span class="preprocessor"></span><span class="preprocessor">#if !defined(PNG_NO_CHECK_cHRM)</span>
<a name="l00815"></a>00815 <span class="preprocessor"></span>
<a name="l00816"></a>00816 <span class="comment">/*</span>
<a name="l00817"></a>00817 <span class="comment"> *    Multiply two 32-bit numbers, V1 and V2, using 32-bit</span>
<a name="l00818"></a>00818 <span class="comment"> *    arithmetic, to produce a 64 bit result in the HI/LO words.</span>
<a name="l00819"></a>00819 <span class="comment"> *</span>
<a name="l00820"></a>00820 <span class="comment"> *                  A B</span>
<a name="l00821"></a>00821 <span class="comment"> *                x C D</span>
<a name="l00822"></a>00822 <span class="comment"> *               ------</span>
<a name="l00823"></a>00823 <span class="comment"> *              AD || BD</span>
<a name="l00824"></a>00824 <span class="comment"> *        AC || CB || 0</span>
<a name="l00825"></a>00825 <span class="comment"> *</span>
<a name="l00826"></a>00826 <span class="comment"> *    where A and B are the high and low 16-bit words of V1,</span>
<a name="l00827"></a>00827 <span class="comment"> *    C and D are the 16-bit words of V2, AD is the product of</span>
<a name="l00828"></a>00828 <span class="comment"> *    A and D, and X || Y is (X &lt;&lt; 16) + Y.</span>
<a name="l00829"></a>00829 <span class="comment">*/</span>
<a name="l00830"></a>00830 
<a name="l00831"></a>00831 <span class="keywordtype">void</span> <span class="comment">/* PRIVATE */</span>
<a name="l00832"></a><a class="code" href="png_8c.html#a368bccce70dc162eb57d4e865a47b9b6">00832</a> <a class="code" href="png_8c.html#a368bccce70dc162eb57d4e865a47b9b6">png_64bit_product</a> (<span class="keywordtype">long</span> v1, <span class="keywordtype">long</span> v2, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *hi_product,
<a name="l00833"></a>00833    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *lo_product)
<a name="l00834"></a>00834 {
<a name="l00835"></a>00835    <span class="keywordtype">int</span> a, <a class="code" href="jpegint_8h.html#af320905358fa78701e4cc60b6135601f">b</a>, c, d;
<a name="l00836"></a>00836    <span class="keywordtype">long</span> lo, hi, <a class="code" href="test_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <a class="code" href="test_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>;
<a name="l00837"></a>00837 
<a name="l00838"></a>00838    a = (v1 &gt;&gt; 16) &amp; 0xffff;
<a name="l00839"></a>00839    b = v1 &amp; 0xffff;
<a name="l00840"></a>00840    c = (v2 &gt;&gt; 16) &amp; 0xffff;
<a name="l00841"></a>00841    d = v2 &amp; 0xffff;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843    lo = b * d;                   <span class="comment">/* BD */</span>
<a name="l00844"></a>00844    x = a * d + c * <a class="code" href="jpegint_8h.html#af320905358fa78701e4cc60b6135601f">b</a>;            <span class="comment">/* AD + CB */</span>
<a name="l00845"></a>00845    y = ((lo &gt;&gt; 16) &amp; 0xffff) + <a class="code" href="test_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>;
<a name="l00846"></a>00846 
<a name="l00847"></a>00847    lo = (lo &amp; 0xffff) | ((y &amp; 0xffff) &lt;&lt; 16);
<a name="l00848"></a>00848    hi = (y &gt;&gt; 16) &amp; 0xffff;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850    hi += a * c;                  <span class="comment">/* AC */</span>
<a name="l00851"></a>00851 
<a name="l00852"></a>00852    *hi_product = (<span class="keywordtype">unsigned</span> long)hi;
<a name="l00853"></a>00853    *lo_product = (<span class="keywordtype">unsigned</span> long)lo;
<a name="l00854"></a>00854 }
<a name="l00855"></a>00855 
<a name="l00856"></a>00856 <span class="keywordtype">int</span> <span class="comment">/* PRIVATE */</span>
<a name="l00857"></a><a class="code" href="png_8c.html#a0c9c953b268f8e9a6fe494157b18e825">00857</a> <a class="code" href="png_8c.html#a0c9c953b268f8e9a6fe494157b18e825">png_check_cHRM_fixed</a>(<a class="code" href="png_8h.html#a431351f0dcae8200b5514bcc9c506217">png_structp</a> png_ptr,
<a name="l00858"></a>00858    <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#a662bef2bfd3b56cec0b0d908e809396c">white_x</a>, <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#adfa66062b6dec50e1d11661275e145fa">white_y</a>, <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#a76a1c169b0088be5a486abd95208aee6">red_x</a>,
<a name="l00859"></a>00859    <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#a6bdde51a9c2dc775239284d6ecd8ce40">red_y</a>, <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#a7a5da09532668258113c579edca4bb64">green_x</a>, <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#af480d63f945ad6a3b796dc7fd0807b5f">green_y</a>,
<a name="l00860"></a>00860    <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#a3e59239d7578c00a79461e68828c1f5a">blue_x</a>, <a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a> <a class="code" href="png_8h.html#a5ad79d2be3261e79dc098d64c018e391">blue_y</a>)
<a name="l00861"></a>00861 {
<a name="l00862"></a>00862    <span class="keywordtype">int</span> ret = 1;
<a name="l00863"></a>00863    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> xy_hi,xy_lo,yx_hi,yx_lo;
<a name="l00864"></a>00864 
<a name="l00865"></a>00865    <a class="code" href="png_8h.html#a902d9c110d356b4d47a47e4b4233ca27">png_debug</a>(1, <span class="stringliteral">&quot;in function png_check_cHRM_fixed&quot;</span>);
<a name="l00866"></a>00866    <span class="keywordflow">if</span> (png_ptr == <a class="code" href="forms_8H-2.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00867"></a>00867       <span class="keywordflow">return</span> 0;
<a name="l00868"></a>00868 
<a name="l00869"></a>00869    <span class="keywordflow">if</span> (white_x &lt; 0 || white_y &lt;= 0 ||
<a name="l00870"></a>00870          red_x &lt; 0 ||   red_y &lt;  0 ||
<a name="l00871"></a>00871        green_x &lt; 0 || green_y &lt;  0 ||
<a name="l00872"></a>00872         blue_x &lt; 0 ||  blue_y &lt;  0)
<a name="l00873"></a>00873    {
<a name="l00874"></a>00874       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr,
<a name="l00875"></a>00875         <span class="stringliteral">&quot;Ignoring attempt to set negative chromaticity value&quot;</span>);
<a name="l00876"></a>00876       ret = 0;
<a name="l00877"></a>00877    }
<a name="l00878"></a>00878    <span class="keywordflow">if</span> (white_x &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> ||
<a name="l00879"></a>00879        white_y &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> ||
<a name="l00880"></a>00880          red_x &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> ||
<a name="l00881"></a>00881          red_y &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> ||
<a name="l00882"></a>00882        green_x &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> ||
<a name="l00883"></a>00883        green_y &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> ||
<a name="l00884"></a>00884         blue_x &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> ||
<a name="l00885"></a>00885         blue_y &gt; (<a class="code" href="pngconf_8h.html#ad346e9127ae0a236421481b814a6a682">png_fixed_point</a>) <a class="code" href="png_8h.html#a0b556d453710c010390b80ce26c4e818">PNG_UINT_31_MAX</a> )
<a name="l00886"></a>00886    {
<a name="l00887"></a>00887       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr,
<a name="l00888"></a>00888         <span class="stringliteral">&quot;Ignoring attempt to set chromaticity value exceeding 21474.83&quot;</span>);
<a name="l00889"></a>00889       ret = 0;
<a name="l00890"></a>00890    }
<a name="l00891"></a>00891    <span class="keywordflow">if</span> (white_x &gt; 100000L - white_y)
<a name="l00892"></a>00892    {
<a name="l00893"></a>00893       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr, <span class="stringliteral">&quot;Invalid cHRM white point&quot;</span>);
<a name="l00894"></a>00894       ret = 0;
<a name="l00895"></a>00895    }
<a name="l00896"></a>00896    <span class="keywordflow">if</span> (red_x &gt; 100000L - red_y)
<a name="l00897"></a>00897    {
<a name="l00898"></a>00898       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr, <span class="stringliteral">&quot;Invalid cHRM red point&quot;</span>);
<a name="l00899"></a>00899       ret = 0;
<a name="l00900"></a>00900    }
<a name="l00901"></a>00901    <span class="keywordflow">if</span> (green_x &gt; 100000L - green_y)
<a name="l00902"></a>00902    {
<a name="l00903"></a>00903       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr, <span class="stringliteral">&quot;Invalid cHRM green point&quot;</span>);
<a name="l00904"></a>00904       ret = 0;
<a name="l00905"></a>00905    }
<a name="l00906"></a>00906    <span class="keywordflow">if</span> (blue_x &gt; 100000L - blue_y)
<a name="l00907"></a>00907    {
<a name="l00908"></a>00908       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr, <span class="stringliteral">&quot;Invalid cHRM blue point&quot;</span>);
<a name="l00909"></a>00909       ret = 0;
<a name="l00910"></a>00910    }
<a name="l00911"></a>00911 
<a name="l00912"></a>00912    <a class="code" href="png_8c.html#a368bccce70dc162eb57d4e865a47b9b6">png_64bit_product</a>(green_x - red_x, blue_y - red_y, &amp;xy_hi, &amp;xy_lo);
<a name="l00913"></a>00913    <a class="code" href="png_8c.html#a368bccce70dc162eb57d4e865a47b9b6">png_64bit_product</a>(green_y - red_y, blue_x - red_x, &amp;yx_hi, &amp;yx_lo);
<a name="l00914"></a>00914 
<a name="l00915"></a>00915    <span class="keywordflow">if</span> (xy_hi == yx_hi &amp;&amp; xy_lo == yx_lo)
<a name="l00916"></a>00916    {
<a name="l00917"></a>00917       <a class="code" href="pngerror_8c.html#a34b3bb3a1ff0050b9317c3ca6d18df24">png_warning</a>(png_ptr,
<a name="l00918"></a>00918          <span class="stringliteral">&quot;Ignoring attempt to set cHRM RGB triangle with zero area&quot;</span>);
<a name="l00919"></a>00919       ret = 0;
<a name="l00920"></a>00920    }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922    <span class="keywordflow">return</span> ret;
<a name="l00923"></a>00923 }
<a name="l00924"></a>00924 <span class="preprocessor">#endif </span><span class="comment">/* NO_PNG_CHECK_cHRM */</span>
<a name="l00925"></a>00925 <span class="preprocessor">#endif </span><span class="comment">/* PNG_cHRM_SUPPORTED */</span>
<a name="l00926"></a>00926 <span class="preprocessor">#endif </span><span class="comment">/* defined(PNG_READ_SUPPORTED) || defined(PNG_WRITE_SUPPORTED) */</span>
</pre></div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="png_8c.html">png.c</a>      </li>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="#" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3</small></address>
</body>

<!-- Mirrored from dox.sfr-fresh.com/fltk-1.3.0rc3-source/png_8c_source.html by HTTrack Website Copier/3.x [XR&CO'2010], Wed, 16 Feb 2011 23:40:03 GMT -->
</html>
